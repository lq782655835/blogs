(window.webpackJsonp=window.webpackJsonp||[]).push([[200],{698:function(s,n,a){"use strict";a.r(n);var e=a(9),l=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"记一次npm升级最新包过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#记一次npm升级最新包过程"}},[s._v("#")]),s._v(" 记一次npm升级最新包过程")]),s._v(" "),a("h2",{attrs:{id:"问题："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题："}},[s._v("#")]),s._v(" 问题：")]),s._v(" "),a("p",[s._v("node以前版本是8.6.0，匹配的npm是5.4。npm全局安装包目录会在"),a("code",[s._v("/usr/local/Cellar/node/")]),s._v("，生成command命令会软链到"),a("code",[s._v("/usr/local/bin")]),s._v("(这也是~/.ssh/.zshrc里指定的命令查询路径，所以可以不输入完整路径即可找到)。")]),s._v(" "),a("p",[s._v("但有次macOS系统升级了，node版本也自动升级到v13.6版本了，所以导致npm install -g vusion会把vusion包放在新的node@v13.6包下的node_modules位置。不会覆盖以前node@v5.4目录下安装的vusion。")]),s._v(" "),a("p",[s._v("但npm没有对应的升级。")]),s._v(" "),a("h2",{attrs:{id:"分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分析"}},[s._v("#")]),s._v(" 分析")]),s._v(" "),a("p",[s._v("使用某个版本（@version）的node时，执行npm install -g，会把包放在/usr/local/Cellar/node/@verson/lib/node_modules下，同时生成软链接到"),a("code",[s._v("/usr/local/bin")]),s._v("。\n当切换node版本时，再想升级以前的包，就找不到对应位置了，所以此时要想升级vusion包，只能先删除以前的，再到新的node环境新建个新的。")]),s._v(" "),a("h2",{attrs:{id:"解决方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[s._v("#")]),s._v(" 解决方案")]),s._v(" "),a("p",[s._v("首先要升级npm，这是必需的。因为node已经为新的了，npm最好升级下。")]),s._v(" "),a("p",[s._v("把以前的vusion包以及软链接删除，再在新的node下安装新的vusion包以及软链。")]),s._v(" "),a("ol",[a("li",[s._v("切换到指定的node@13.6，升级npm：（node都升级了，npm最好也升级下）")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo npm install -g npm\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("删除老版本vusion包以及对应软链接。")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("rm -rf /usr/local/bin/vusion // 删除软链接\nrm -rf /usr/local/Cellar/node/8.6.0/lib/node_modules/vusion //删除源文件  或者nvm use 8.6.0 -> npm uninstall -g vusion\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("创建新的vusion包")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("nvm use 13.6\nnpm install -g vusion\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("~/.zshrc下手动绑定软链/usr/local/Cellar/node/13.6.0/bin/")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("source ~/.zshrc // 使得.zshrc有效\n")])])]),a("p",[s._v("/usr/local/Cellar/node/13.6.0/bin/vusion -> /usr/local/Cellar/node/13.6.0/lib/node_modules/vusion/bin/vusion\n/Users/liaoqiao/.nvm/versions/node/v12.13.0/bin/vusion -> /Users/liaoqiao/.nvm/versions/node/v12.13.0/lib/node_modules/vusion/bin/vusion")])])}),[],!1,null,null,null);n.default=l.exports}}]);